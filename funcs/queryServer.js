!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports["queryServer.js"]=t():e["queryServer.js"]=t()}(global,(()=>(()=>{var e={141:function(e,t){"use strict";!function(e){var r=function(e,t){const r=this;switch("undefined"!=typeof Buffer&&(e=Buffer.isBuffer(e)&&e||"string"==typeof e&&Buffer.from(e)||e&&e.constructor===Array&&Buffer.from(e)||Buffer.alloc(0)),e=e||[],t=t||{},r.buffer=e,r.bytes_per_line=parseInt(t.width)||16,r.numbering="none"==t.numbering?"none":"hex_bytes",r.bytes_per_group=2,t.format){case"none":r.bytes_per_group=0;break;case"twos":r.bytes_per_group=1;break;case"eights":r.bytes_per_group=4;break;case"sixteens":r.bytes_per_group=8}switch(r.littleEndian=t.littleEndian||!1,r.radix=t.radix||16,r.caps="upper"==t.caps?"upper":"lower",r.annotate="none"==t.annotate?"none":"ascii",r.prefix=t.prefix||"",r.indent=t.indent||0,r.html=t.html||!1,r.offset=t.offset||0,r.length=t.length||-1,r.extendedChs=t.extendedChs||!1,r.display_offset=t.display_offset||0,r.offset&&r.offset<r.buffer.length&&(r.buffer=r.buffer.slice(r.offset)),-1!==r.length&&r.length<=r.buffer.length&&(r.buffer=r.buffer.slice(0,r.length)),r.prefix=(r.html?"&nbsp;":" ").repeat(r.indent)+r.prefix,r.hex_line_length=o(r.bytes_per_group,r.radix)*r.bytes_per_line/Math.max(r.bytes_per_group,1),r.bytes_per_group){case 8:case 4:case 2:r.hex_line_length+=Math.floor(r.bytes_per_line/r.bytes_per_group);break;case 1:r.hex_line_length+=r.bytes_per_line+3;break;case 0:r.hex_line_length+=2}r.bytes_per_group=Math.min(r.bytes_per_group,r.bytes_per_line),this.toString=function(){var e="",t=r.offset+r.display_offset,o=!1;r.html&&(e+="<div class='hexy'>\n");for(var s=0;s<r.buffer.length;s+=r.bytes_per_line){const c=Math.min(s+r.bytes_per_line,r.buffer.length),u=r.buffer.slice(s,c);if(r.html&&(e+="<div class='"+a(t,8,16)+(o?"  odd":" even")+"'>",o=!o),e+=r.prefix,"hex_bytes"===r.numbering&&(e+=a(t,8,16)+": "),e+=n(u,r.bytes_per_line,r.bytes_per_group,r.radix,r.littleEndian),"ascii"===r.annotate){var i="";switch(u.constructor){case Array:i=String.fromCharCode.apply(r,u);break;case Uint8Array:u.forEach((e=>i+=String.fromCharCode(e)));break;default:i=u.toString("latin1")}e+=" "+(r.html?f(i):l(i))}e+=r.html?"</div>\n":"\n",t+=r.bytes_per_line}return r.html&&(e+="</div>\n"),e};var n=function(e,t,n,a,i){var c="";const l=0==n?"":" ",f=o(n,a),u=(t-e.length)*(0==n?f:(f+1)/n);0==n&&(n=1);const p=i?n-1:0,y=i?-1:n,d=i?-1:1;for(var h=0;h<e.length/n;++h){for(var m=n<4?0:BigInt(0),g=p;g!=y;g+=d){const t=h*n+g;if(t>=e.length)break;m=n<4?256*m+(255&(e.constructor==String?e.codePointAt(t):e[t])):256n*BigInt(m)+BigInt(255&(e.constructor==String?e.codePointAt(t):e[t]))}const t=m.toString(a);for(var w=0;w<f-t.length;w++)c+="0";c+=t,c+=l,"upper"===r.caps&&(c=c.toUpperCase())}return e.length<t&&(c+=(r.html?"&nbsp;":" ").repeat(u)),c=s(c,r.hex_line_length)},a=function(e,t,r){const n=e.toString(r);return"0".repeat(t-n.length)+n},s=function(e,t){const n=t-e.length-1;return n>0&&(e+=(r.html?"&nbsp;":" ").repeat(n)),e};const i=/[^\x20-\x7f]/g,c=/[\x00-\x1f]/g;var l=function(e){return e.replace(r.extendedChs?c:i,".")},f=function(e){return e=(e=(e=e.replace(/&/g,"&amp;")).replace(/</g,"&lt;")).replace(/>/g,"&gt;"),e=r.extendedChs?(e=(e=e.replace(/\'/g,"&apos;")).replace(/\"/g,"&quot;")).replace(i,(function(e){return"&#x"+(e=e.codePointAt(0)).toString(16)+";"})):e.replace(i,".")}};r.VERSION="0.3.4";var n,o=function(e,t){var r=2;switch(0==e&&(e=1),t){case 2:r=8*e;break;case 8:switch(e){case 1:r=3;break;case 2:r=6;break;case 4:r=11;break;case 8:r=22}break;case 10:switch(e){case 1:r=3;break;case 2:r=6;break;case 4:r=10;break;case 8:r=20}break;case 16:r=2*e}return r};(n=t).hexy=function(e,t){return new r(e,t).toString()},n.Hexy=r,n.maxnumberlen=o}()},277:(e,t,r)=>{"use strict";r.r(t),r.d(t,{NIL:()=>E,parse:()=>g,stringify:()=>u,v1:()=>m,v3:()=>b,v4:()=>v,v5:()=>k,validate:()=>l,version:()=>I});var n=r(113),o=r.n(n);const a=new Uint8Array(256);let s=a.length;function i(){return s>a.length-16&&(o().randomFillSync(a),s=0),a.slice(s,s+=16)}const c=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;const l=function(e){return"string"==typeof e&&c.test(e)},f=[];for(let e=0;e<256;++e)f.push((e+256).toString(16).substr(1));const u=function(e,t=0){const r=(f[e[t+0]]+f[e[t+1]]+f[e[t+2]]+f[e[t+3]]+"-"+f[e[t+4]]+f[e[t+5]]+"-"+f[e[t+6]]+f[e[t+7]]+"-"+f[e[t+8]]+f[e[t+9]]+"-"+f[e[t+10]]+f[e[t+11]]+f[e[t+12]]+f[e[t+13]]+f[e[t+14]]+f[e[t+15]]).toLowerCase();if(!l(r))throw TypeError("Stringified UUID is invalid");return r};let p,y,d=0,h=0;const m=function(e,t,r){let n=t&&r||0;const o=t||new Array(16);let a=(e=e||{}).node||p,s=void 0!==e.clockseq?e.clockseq:y;if(null==a||null==s){const t=e.random||(e.rng||i)();null==a&&(a=p=[1|t[0],t[1],t[2],t[3],t[4],t[5]]),null==s&&(s=y=16383&(t[6]<<8|t[7]))}let c=void 0!==e.msecs?e.msecs:Date.now(),l=void 0!==e.nsecs?e.nsecs:h+1;const f=c-d+(l-h)/1e4;if(f<0&&void 0===e.clockseq&&(s=s+1&16383),(f<0||c>d)&&void 0===e.nsecs&&(l=0),l>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");d=c,h=l,y=s,c+=122192928e5;const m=(1e4*(268435455&c)+l)%4294967296;o[n++]=m>>>24&255,o[n++]=m>>>16&255,o[n++]=m>>>8&255,o[n++]=255&m;const g=c/4294967296*1e4&268435455;o[n++]=g>>>8&255,o[n++]=255&g,o[n++]=g>>>24&15|16,o[n++]=g>>>16&255,o[n++]=s>>>8|128,o[n++]=255&s;for(let e=0;e<6;++e)o[n+e]=a[e];return t||u(o)};const g=function(e){if(!l(e))throw TypeError("Invalid UUID");let t;const r=new Uint8Array(16);return r[0]=(t=parseInt(e.slice(0,8),16))>>>24,r[1]=t>>>16&255,r[2]=t>>>8&255,r[3]=255&t,r[4]=(t=parseInt(e.slice(9,13),16))>>>8,r[5]=255&t,r[6]=(t=parseInt(e.slice(14,18),16))>>>8,r[7]=255&t,r[8]=(t=parseInt(e.slice(19,23),16))>>>8,r[9]=255&t,r[10]=(t=parseInt(e.slice(24,36),16))/1099511627776&255,r[11]=t/4294967296&255,r[12]=t>>>24&255,r[13]=t>>>16&255,r[14]=t>>>8&255,r[15]=255&t,r};function w(e,t,r){function n(e,n,o,a){if("string"==typeof e&&(e=function(e){e=unescape(encodeURIComponent(e));const t=[];for(let r=0;r<e.length;++r)t.push(e.charCodeAt(r));return t}(e)),"string"==typeof n&&(n=g(n)),16!==n.length)throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");let s=new Uint8Array(16+e.length);if(s.set(n),s.set(e,n.length),s=r(s),s[6]=15&s[6]|t,s[8]=63&s[8]|128,o){a=a||0;for(let e=0;e<16;++e)o[a+e]=s[e];return o}return u(s)}try{n.name=e}catch(e){}return n.DNS="6ba7b810-9dad-11d1-80b4-00c04fd430c8",n.URL="6ba7b811-9dad-11d1-80b4-00c04fd430c8",n}const b=w("v3",48,(function(e){return Array.isArray(e)?e=Buffer.from(e):"string"==typeof e&&(e=Buffer.from(e,"utf8")),o().createHash("md5").update(e).digest()}));const v=function(e,t,r){const n=(e=e||{}).random||(e.rng||i)();if(n[6]=15&n[6]|64,n[8]=63&n[8]|128,t){r=r||0;for(let e=0;e<16;++e)t[r+e]=n[e];return t}return u(n)};const k=w("v5",80,(function(e){return Array.isArray(e)?e=Buffer.from(e):"string"==typeof e&&(e=Buffer.from(e,"utf8")),o().createHash("sha1").update(e).digest()})),E="00000000-0000-0000-0000-000000000000";const I=function(e){if(!l(e))throw TypeError("Invalid UUID");return parseInt(e.substr(14,1),16)}},988:e=>{e.exports=function e(t,r){var n,o=0,a=0,s=r=r||0,i=t.length;do{if(s>=i||a>49)throw e.bytes=0,new RangeError("Could not decode varint");n=t[s++],o+=a<28?(127&n)<<a:(127&n)*Math.pow(2,a),a+=7}while(n>=128);return e.bytes=s-r,o}},312:e=>{e.exports=function e(r,n,o){if(Number.MAX_SAFE_INTEGER&&r>Number.MAX_SAFE_INTEGER)throw e.bytes=0,new RangeError("Could not encode varint");n=n||[];var a=o=o||0;for(;r>=t;)n[o++]=255&r|128,r/=128;for(;-128&r;)n[o++]=255&r|128,r>>>=7;return n[o]=0|r,e.bytes=o-a+1,n};var t=Math.pow(2,31)},676:(e,t,r)=>{e.exports={encode:r(312),decode:r(988),encodingLength:r(82)}},82:e=>{var t=Math.pow(2,7),r=Math.pow(2,14),n=Math.pow(2,21),o=Math.pow(2,28),a=Math.pow(2,35),s=Math.pow(2,42),i=Math.pow(2,49),c=Math.pow(2,56),l=Math.pow(2,63);e.exports=function(e){return e<t?1:e<r?2:e<n?3:e<o?4:e<a?5:e<s?6:e<i?7:e<c?8:e<l?9:10}},138:(e,t,r)=>{"use strict";r(147),r(277);const{verifyHostname:n,ConnectionError:o,merge:a}=r(717),{queryQuery:s}=r(510),{queryBedrock:i}=r(858),{queryJava:c}=r(605),{Bedrock:l,Java:f,Query:u}=r(946),p=5e3,y=r(837),d=r(604),h=y.promisify(d.resolveSrv);e.exports=async function(e,t=null){const[r,o]=e.split(":",2);if(!n(r))throw new Error("Host is invalid");let l,f;if(t){if("number"!=typeof t)throw new Error("Port argument is not a number");l=t}else if(o){if(!/^\d+$/.test(o))throw new Error("Port section of host argument is not a number");l=Number.parseInt(o)}if(l<0||l>65535)throw new Error("Port is out of range (0-65535)");try{f=await h(`_minecraft._tcp.${r}`)}catch{}const u={motd:null,version:null,latency:null,players:{online:null,max:null,list:null},favicon:null,ip:r.toLowerCase(),type:null},y=[],d=(e,t)=>{switch(t&&y.push([s,[e,t,p]]),t){case 25565:y.push([c,[e,t,p]]);break;case 19132:y.push([i,[e,t,p]]);break;case null:y.push([s,[e,25565,p]]),y.push([s,[e,19132,p]]);default:y.push([c,[e,t||25565,p]]),y.push([i,[e,t||19132,p]])}};if(f?.length)for(const{name:e,port:t}of f)d(e,t);let m;if(d(r,l),m=await Promise.allSettled(y.map((([e,t])=>e.apply(null,t)))),m.every((({status:e})=>"rejected"===e)))throw new AggregateError(m.map((({reason:e})=>e)),"All query promises rejected");m.filter((({status:e})=>"fulfilled"===e)).map((({value:e})=>e)).forEach((e=>{u.type&&u.type!==e.type&&(u.type="Crossplay"),a(u,e)})),"string"==typeof u.motd&&(u.motd=u.motd.replace(/[ยง\uFFFD][0-9a-fk-or]/gi,"").split("\n").map((e=>e.trim())).filter((e=>e.length)).join("\n")),u.motd||="",u.version||="Unknown",u.players.list&&=u.players.list.map((({uuid:e,name:t})=>({uuid:e,name:t.replace(/ยง[0-9a-fk-or]/gi,"")}))),u.players.list||=[],u.type||="Unknown";try{const e=JSON.parse(u.motd.replace(/-/g,'"'));"string"==typeof e?.name&&(u.motd=e?.name)}catch{}return m.map(((e,t)=>[e,t])).filter((([{status:e}])=>"rejected"===e)).map((([{reason:e},t])=>[e,t])).forEach((([e,t])=>{})),u}},448:(e,t,r)=>{const{PacketTypes:n}=r(841),{encode:o,_packetize:a}=r(628),s=r(653);e.exports=class{constructor(e,t=null,r){if(!(e instanceof Array))throw new Error("Packet format must be an array");if(!e.every((e=>{if("object"!=typeof e)return!1;try{e.getOnlyKey()}catch(e){return!1}return!0})))throw new Error('Packet format is not of type {"key": DT}[]');if(!Object.keys(n).map((e=>n[e])).includes(r))throw new Error("packetType must be a member of PacketTypes");switch(r){case n.Raknet:if("number"!=typeof t||t<0||t>255)throw new Error("packetID must be a number between 0-255");break;case n.Java:if("number"!=typeof t)throw new Error("packetID must be a number")}this.packetID=t,this.packetFormat=e,this.packetType=r}encode=o;_packetize=a;decode=s}},653:(e,t,r)=>{const{DataTypes:n,PacketTypes:o,LEGACY_MAGIC:a,RAKNET_MAGIC:s}=r(841),i=r(676),{show_hexy:c}=r(717);e.exports=function(e,t=[]){if(!(e instanceof Buffer))throw new Error("Argument must be a buffer");if(!(t instanceof Array)||t.find((e=>"number"!=typeof e)))throw new Error("fixedByteLengths must be of type number[]");let r=0;switch(this.packetType){case o.Raknet:{const t=e.readInt8();if(r+=1,t!==this.packetID)throw new Error(`Raknet Packet ID mismatch: read 0x${t.toString(16)}, expected 0x${this.packetID.toString(16)}`)}break;case o.Java:{i.decode(e);r+=i.decode.bytes;const t=i.decode(e,r);if(r+=i.decode.bytes,this.packetID!==t)throw new Error(`Java Packet ID mismatch: read 0x${t.toString(16)}, expected 0x${this.packetID.toString(16)}`)}break;case o.Raw:break;default:throw new Error(`Invalid packet type decoded: ${o.getByValue(this.packetType)}`)}const a={};for(const o of this.packetFormat){const c=o.getOnlyKey(),l=o[c];switch(l){case n.UByte:a[c]=e.readUInt8(r),r+=1;break;case n.UShortLE:a[c]=e.readUint16LE(r),r+=2;break;case n.Int32BE:a[c]=e.readInt32BE(r),r+=4;break;case n.Int64BE:a[c]=e.readBigInt64BE(r),r+=8;break;case n.FixedByteArray:{if(0===t.length)throw new Error(`Key ${c} of type FixedByteArray required a fixed byte length to be in the fixedByteLengths array`);const n=t.shift();a[c]=e.slice(r,r+n),r+=n}break;case n.RAKNET_MAGIC:{const t=e.slice(r,r+s.length);if(t.length!==s.length)throw new Error("Failed to read MAGIC string, ran out of bytes");if(0!==t.compare(s))throw new Error("Read MAGIC item, value is not equal to MAGIC value: "+t.toString());a[c]=t,r+=16}break;case n.NullTerminatedString:{let t;for(t=0;0!=e[r+t]&&r+t<e.length;t++);a[c]=e.slice(r,r+t).toString("utf-8"),r+=t+1,0===e[r]&&r++}break;case n.NullTerminatedStringArray:{const t=[];do{let n;for(n=0;0!=e[r+n]&&r+n<e.length;n++);t.push(e.slice(r,r+n).toString("utf-8")),r+=n+1}while(t[t.length-1]||"plugins"===t[t.length-2]);0===e[r]&&r++,a[c]=t.slice(0,-1)}break;case n.UShortString:{const t=e.readUInt16BE(r);r+=2;const n=e.slice(r,r+t),o=n.toString("utf-8");if(r+=t,n.length!==t)throw new Error(`Failed to read string, ran out of bytes (read: ${n.length}, expected: ${t})`);a[c]=o}break;case n.VarIntString:{const t=i.decode(e)-(i.decode.bytes+1);r+=i.decode.bytes;const n=e.slice(r,r+t),o=n.toString("utf-8");r+=t,n.length,a[c]=o}break;default:throw new Error(`Invalid data type value processed: ${n.getByValue(l)}`)}}if(e.length!==r){const t=`Buffer offset mismatch: length=${e.length}, offset=${r}`;throw new Error(t)}return a}},628:(e,t,r)=>{const{DataTypes:n,PacketTypes:o,LEGACY_MAGIC:a,RAKNET_MAGIC:s}=r(841),i=r(676),{show_hexy:c}=r(717);function l(e,t,r,...o){if(!o.every((e=>e)))throw new Error(`Key "${e}" of type ${n.getByValue(t)} expects value to be ${r}`)}e.exports={encode:function(e){if("object"!=typeof e)throw new Error("PacketTool.encode takes an object as argument");if(e instanceof Array)throw new Error("PacketTool.encode does not take an array, simply an object");let t=this.packetFormat.map((e=>e.getOnlyKey())).find((t=>!(t in e)));if(t)throw new Error(`Object is missing key ${t} in packet format`);const r=[];for(const t of this.packetFormat){const o=t.getOnlyKey(),c=e[o],f=t[o];try{switch(f){case n.UByte:l(o,f,"a whole number between 0 and 255","number"==typeof c,c>=0,c<=255,c%1==0),r.push(Buffer.from([c]));break;case n.UShortLE:{l(o,f,"a whole number between 0 and 65535","number"==typeof c,c>=0,c<=65535,c%1==0);const e=Buffer.alloc(2);e.writeUInt16LE(c),r.push(e)}break;case n.UShortBE:{l(o,f,"a whole number between 0 and 65535","number"==typeof c,c>=0,c<=65535,c%1==0);const e=Buffer.alloc(2);e.writeUInt16BE(c),r.push(e)}break;case n.Int32BE:{l(o,f,"a whole number between -2147483648 and 2147483647","number"==typeof c,c>=1<<31,c<=~(1<<31),c%1==0);const e=Buffer.alloc(4);e.writeInt32BE(c),r.push(e)}break;case n.Int64BE:{l(o,f,"a whole number between -9223372036854775808 and 9223372036854775807","bigint"==typeof c,c>=-(2n**63n)+1n,c<=2n**63n,c%1n===0n);const e=Buffer.alloc(8);e.writeBigInt64BE(c),r.push(e)}break;case n.VarInt:{l(o,f,"an integer",["number","bigint"].includes(typeof c),c%1==0);const e=Buffer.from(i.encode(c));r.push(e)}break;case n.LEGACY_MAGIC:l(o,f,"null",null===c),r.push(a);break;case n.RAKNET_MAGIC:l(o,f,"null",null===c),r.push(s);break;case n.FixedByteArray:l(o,f,"of type Buffer",c instanceof Buffer),r.push(c);break;case n.VarIntString:{l(o,f,"of type string","string"==typeof c);const e=Buffer.from(c),t=Buffer.from(i.encode(e.length));r.push(t,e)}break;default:throw new Error(`Invalid data type value processed: ${n.getByValue(f)}`)}}catch(e){throw e}}return this._packetize(r)},_packetize:function(e){switch(this.packetType){case o.Raknet:{const t=Buffer.alloc(1);return t.writeUInt8(this.packetID),Buffer.concat([t,...e])}case o.Java:{const t=Buffer.from(i.encode(this.packetID)),r=Buffer.concat([t,...e]),n=Buffer.from(i.encode(r.length));return Buffer.concat([n,r])}case o.Raw:return Buffer.concat(e);default:throw new Error(`Invalid packet type processed: ${o.getByValue(this.packetType)}`)}}}},717:(e,t,r)=>{r(891);const{hexy:n}=r(141);Object.prototype.getByValue=function(e){return Object.keys(this).find((t=>e===this[t]))},String.prototype.hexToBuffer=function(){if(!/^([0-9a-fA-F]{2})*$/g.test(this))throw new Error("Invalid this cannot be made into a buffer");const e=Buffer.alloc(this.length/2),t=this.match(/../g);for(let r=0;r<t.length;r++)e[r]=Number.parseInt(t[r],16);return e},Object.prototype.getOnlyKey=function(e){const t=Object.keys(this);if(1!==t.length)return null;return t.pop()};let o=0;class a extends Error{constructor(e){super(e),this.name="ConnectionError"}}const s=(e,t)=>{Object.keys(t).forEach((r=>{e[r]?"object"==typeof t[r]&&null!==t[r]&&"object"==typeof e[r]&&null!==e[r]&&s(e[r],t[r]):e[r]=t[r]}))};e.exports={verifyHostname:function(e){if("string"!=typeof e)return!1;const t=e.split(".").filter((e=>e.length>0));return!!/^[a-zA-Z0-9\-_\.]{1,253}$/g.test(e)&&t.every((e=>/^[a-zA-Z0-9\-_]{1,63}$/g.test(e)&&!(e.startsWith("-")||e.endsWith("-"))))},stringArrayToObject:function(e){if(!(e instanceof Array))throw new Error("Argument must be of type Array");if(e.find((e=>"string"!=typeof e)))throw new Error("Argument must be an array of strings");const t={};for(let r=0;r<e.length;r+=2)t[e[r]]=e[r+1];return t},show_hexy:(e,t)=>{},auto:()=>++o,removeFormatting:e=>e.replace(/ยง[0-9a-fk-or]/gi,"").trim(),ConnectionError:a,TimeoutPromise:(e,t)=>new Promise(((r,n)=>setTimeout((()=>n(new a(t+": Connection timed out"))),e))),merge:s}},858:(e,t,r)=>{const n=r(199),o=r(915),a=r(113),s=r(891),{Bedrock:i}=r(946),{stringArrayToObject:c,ConnectionError:l,TimeoutPromise:f}=r(717);async function u(e,t,r){n(e,t,r);const c=f(r,"Bedrock Query"),u=await Promise.race([new Promise(((r,n)=>{const o=s.createSocket({type:"udp4"});o.once("error",(e=>n(new l(e.message)))),o.once("connect",(()=>r(o))),o.connect(t,e)})),c]),p=i.unconnected_ping.encode({time:BigInt(Math.floor(Date.now()/1e3)),magic:null,clientGUID:a.randomBytes(8)}),y=Date.now(),d=await o(u,p,1e3,c);return{latency:Math.ceil(Date.now()-y),buffer:d}}e.exports={queryBedrock:async function(e,t,r){n(...arguments);const o={motd:null,version:null,latency:null,players:{online:null,max:null},type:"Bedrock"},a=await u(e,t,r);if("number"!=typeof a?.latency)throw new Error("No latency returned from queryBedrock");if(o.latency=a.latency,!(a?.buffer instanceof Buffer))throw new Error("No buffer returned from queryBedrock");const s=i.unconnected_pong.decode(a.buffer,[8]);if("string"!=typeof s?.serverID)throw new Error("Decoded buffer does not have serverID");const[,c,,l,f,p,,y]=s.serverID.split(";"),d=[c,y].filter((e=>e)).join("\n");if(!d)throw new Error("No MOTD");if(o.motd=d,!l)throw new Error("No version");if(o.version=l,!/^\d+$/.test(f)||!/^\d+$/.test(p))throw new Error("No online/max");return o.players.online=Number.parseInt(f),o.players.max=Number.parseInt(p),o}}},605:(e,t,r)=>{const n=r(199),o=r(808),a=r(676),{Java:s}=r(946),{show_hexy:i,ConnectionError:c,TimeoutPromise:l}=r(717);function f(e){let t;return new Promise(((r,n)=>{let o,s,i=0;t=e=>{try{if(!s){let t;t=o?a.decode(Buffer.concat([o,e])):a.decode(e),t+=a.decode.bytes,s=Buffer.alloc(t),o&&(o.copy(s),i+=o.length)}if(e.length+i>s.length){const t=`Ran out of space buffer: buffer size is ${s.length} byte(s), offset is ${i} byte(s), chunk length is ${e.length} byte(s)`;throw new Error(t)}e.copy(s,i),i+=e.length,s.length!==i||r(s)}catch(t){if(!s&&t instanceof RangeError)return void(o=e);n(t)}},e.on("data",t)})).finally((()=>e.removeListener("data",t)))}async function u(e,t,r){let n=l(r,"Java Query");const a=await Promise.race([new Promise(((r,n)=>{const a=new o.Socket;a.once("connect",(()=>r(a))),a.once("error",(e=>n(new c(e.message)))),a.connect(t,e)})),n]),i=e=>{a.write(e)},u=s.handshake.encode({protocolVersion:s.protocolVersion,serverAddress:e,serverPort:t,nextState:1}),p=s.request.encode({}),y=s.ping.encode({payload:Buffer.from("sebglhp\0")},8);i(u),i(p);const d=await Promise.race([f(a),n]);i(y);const h=Date.now(),m=await Promise.race([f(a),n]),g=Date.now()-h;return y.compare(m),a.end(),n.catch((()=>{})),{latency:g,buffer:d}}e.exports={queryJava:async function(e,t,r){n(...arguments);const o={motd:null,version:null,latency:null,players:{online:null,max:null,list:null},favicon:null,type:"Java"},a=await u(e,t,r),{buffer:i}=a;"number"==typeof a.latency&&(o.latency=a.latency);try{const e=s.response.decode(i),t=JSON.parse(e.jsonResponse);if("object"!=typeof t)throw new Error("responseAsObject is not an object");if("string"!=typeof t.version?.name)throw new Error("No version in responseAsObject");if(o.version=t.version.name,"object"==typeof t.description){const e=({text:t,extra:r})=>(t??"")+(r??[]).reduce(((t,r)=>t+e(r)),"");o.motd=e(t.description)}else"string"==typeof t.description&&(o.motd=t.description);if("number"!=typeof t.players?.max||"number"!=typeof t.players?.online)throw new Error("Invalid players structure");o.players.max=t.players.max,o.players.online=t.players.online,t.players?.sample?.every((e=>"string"==typeof e?.id||"string"==typeof e?.name))&&(o.players.list=t.players.sample.map((({id:e,name:t})=>({uuid:e,name:t})))),"string"==typeof t?.favicon&&(o.favicon=t.favicon),"string"==typeof t.modinfo?.type&&(o.type=`${t.modinfo.type} ${o.type}`)}catch(e){throw new Error("Strings not implemented")}return o}}},510:(e,t,r)=>{const n=r(199),o=r(915),a=(r(113),r(891)),{Query:s}=r(946),{show_hexy:i,stringArrayToObject:c,ConnectionError:l,TimeoutPromise:f,merge:u}=r(717);async function p(e,t,r){const n=f(r,"Query Query"),i=await Promise.race([new Promise(((r,n)=>{const o=a.createSocket({type:"udp4"});o.once("error",(e=>n(new l(e.message)))),o.once("connect",(()=>r(o))),o.connect(t,e)})),n]),c=Date.now();{const e=s.handshake.encode({magic:null,type:9,sessionID:1,challengeToken:Math.floor(2147483647*Math.random())}),t=await o(i,e,1e3,n),{challenge:r}=s.response.decode(t);var u=Number.parseInt(r)}const p=Math.ceil(Date.now()-c);try{const e=s.basic_stat_request.encode({magic:null,type:0,sessionID:1,challengeToken:u});var y=await o(i,e,1e3,n)}catch{}{const e=s.full_stat_request.encode({magic:null,type:0,sessionID:1,challengeToken:u,padding:Buffer.alloc(4)});var d=await o(i,e,1e3,n)}return{latency:p,basic_buffer:y,full_buffer:d}}function y(e){if(!(e instanceof Buffer))throw new Error("Not a buffer");let t=0;const r=Buffer.from("splitnum\0ย\0","ascii");for(;!r.equals(e.slice(t,t+r.length))&&t<=e.length-r.length;)t++;t+=r.length;const n=Buffer.from([0,0,1]);let o=t;for(;!n.equals(e.slice(o,o+n.length))&&o<=e.length;)o++;const a=e.slice(t,o),s=[];let i="";for(const e of a.values())e?i+=String.fromCharCode(e):(s.push(i),i="");return c(s)}e.exports={queryQuery:async function(e,t,r){n(...arguments);const o={motd:null,version:null,latency:null,players:{online:null,max:null}},{latency:a,basic_buffer:i,full_buffer:l}=await p(e,t,r);if("number"!=typeof a)throw new Error("No latency");if(o.latency=a,i instanceof Buffer){let e;try{e=s.basic_stat_response.decode(i)}catch{try{e=c(s.full_stat_response.decode(i,[11,10]).status)}catch{e=y(i)}}if(!/^\d+$/.test(e.numplayers)||!/^\d+$/.test(e.maxplayers))throw new Error("No numplayers/maxplayers");o.players.online=Number.parseInt(e.numplayers),o.players.max=Number.parseInt(e.maxplayers),o.motd="string"==typeof e?.motd?e.motd:e.hostname,"string"==typeof e?.version&&(o.version=e.version)}return o}}},915:(e,t,r)=>{const{show_hexy:n,auto:o,ConnectionError:a,TimeoutPromise:s}=r(717);e.exports=function(e,t,r,n){Date.now();let o=!1;return n.catch((()=>{o=!0})),new Promise(((n,s)=>{let i;const c=t=>{clearInterval(i),e.removeListener("message",l),s(t)},l=e=>{clearInterval(i),n(e)},f=()=>{if(o)return clearInterval(i),e.removeListener("message",l),e.removeListener("error",c),void s(new a("Timed out"));e.send(t)};e.once("message",l),e.once("error",c),i=setInterval(f,r),f()}))}},199:(e,t,r)=>{const{verifyHostname:n,ConnectionError:o}=r(717);e.exports=function(e,t,r){if(!n(e))throw new o("Host name is invalid");if(!("number"==typeof t&&t%1==0&&t>=0&&t<=65535))throw new o("Port must be a whole number from 0-65535");if(!("number"==typeof r&&r%1==0&&r>=0))throw new o("Timeout must be a whole number from 0-65535");return!0}},841:(e,t,r)=>{const{auto:n}=r(717),o={UByte:n(),UShortLE:n(),UShortBE:n(),Int32BE:n(),Int64BE:n(),VarInt:n(),UShortString:n(),VarIntString:n(),NullTerminatedString:n(),NullTerminatedStringArray:n(),FixedByteArray:n(),RAKNET_MAGIC:n(),LEGACY_MAGIC:n()},a={Raw:n(),Java:n(),Raknet:n()},s="00ffff00fefefefefdfdfdfd12345678".hexToBuffer(),i="fefd".hexToBuffer();e.exports={DataTypes:o,PacketTypes:a,RAKNET_MAGIC:s,LEGACY_MAGIC:i}},946:(e,t,r)=>{const{DataTypes:n,PacketTypes:o}=r(841),a=r(448),{auto:s}=r(717),i={unconnected_ping:new a([{time:n.Int64BE},{magic:n.RAKNET_MAGIC},{clientGUID:n.FixedByteArray}],1,o.Raknet),unconnected_pong:new a([{time:n.Int64BE},{serverGUID:n.FixedByteArray},{magic:n.RAKNET_MAGIC},{serverID:n.UShortString}],28,o.Raknet)},c={protocolVersion:758,handshake:new a([{protocolVersion:n.VarInt},{serverAddress:n.VarIntString},{serverPort:n.UShortBE},{nextState:n.VarInt}],0,o.Java),request:new a([],0,o.Java),response:new a([{jsonResponse:n.VarIntString}],0,o.Java),ping:new a([{payload:n.FixedByteArray}],1,o.Java),pong:new a([{payload:n.FixedByteArray}],1,o.Java)},l={handshake:new a([{magic:n.LEGACY_MAGIC},{type:n.UByte},{sessionID:n.Int32BE},{challengeToken:n.Int32BE}],null,o.Raw),response:new a([{type:n.UByte},{sessionID:n.Int32BE},{challenge:n.NullTerminatedString}],null,o.Raw),basic_stat_request:new a([{magic:n.LEGACY_MAGIC},{type:n.UByte},{sessionID:n.Int32BE},{challengeToken:n.Int32BE}],null,o.Raw),basic_stat_response:new a([{type:n.UByte},{sessionID:n.Int32BE},{motd:n.NullTerminatedString},{gametype:n.NullTerminatedString},{map:n.NullTerminatedString},{numPlayers:n.NullTerminatedString},{maxPlayers:n.NullTerminatedString},{hostPort:n.UShortLE},{hostIP:n.NullTerminatedString}],null,o.Raw),full_stat_request:new a([{magic:n.LEGACY_MAGIC},{type:n.UByte},{sessionID:n.Int32BE},{challengeToken:n.Int32BE},{padding:n.FixedByteArray}],null,o.Raw),full_stat_response:new a([{type:n.UByte},{sessionID:n.Int32BE},{padding:n.FixedByteArray},{status:n.NullTerminatedStringArray},{padding:n.FixedByteArray},{players:n.NullTerminatedStringArray}],null,o.Raw)};e.exports={Bedrock:i,Java:c,Query:l}},113:e=>{"use strict";e.exports=require("crypto")},891:e=>{"use strict";e.exports=require("dgram")},147:e=>{"use strict";e.exports=require("fs")},808:e=>{"use strict";e.exports=require("net")},604:e=>{"use strict";e.exports=require("node:dns")},837:e=>{"use strict";e.exports=require("util")}},t={};function r(n){var o=t[n];if(void 0!==o)return o.exports;var a=t[n]={exports:{}};return e[n].call(a.exports,a,a.exports,r),a.exports}return r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,{a:t}),t},r.d=(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r(138)})()));